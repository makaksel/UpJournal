(()=>{"use strict";document.addEventListener("DOMContentLoaded",(function(){const e=e=>e?e.toLocaleString():null,t=e=>{const t=e.querySelectorAll('input[required][type="text"]'),r=e.querySelectorAll('input[required][type="checkbox"]'),c=Array.from(t).filter((e=>!e.value)),s=Array.from(r).filter((e=>!e.checked));return s.forEach(((e,t)=>{const r=e.closest(".checkbox");r.classList.add("error"),e.addEventListener("change",(()=>{r?.classList.remove("error"),r.querySelector(".text-input__error-text")?.remove()}))})),c.forEach(((e,t)=>{const r=e.closest(".text-input");if(0===t&&e.focus(),r.classList.contains("error"))return;const c=document.createElement("span");c.classList.add("text-input__error-text"),c.append("Поле не заполнено"),r?.classList.add("error"),r.append(c),e.addEventListener("input",(()=>{r?.classList.remove("error"),r.querySelector(".text-input__error-text")?.remove()}))})),0===c.length&&0===s.length},r=document.getElementById("publish-form"),c=document.getElementById("btn-consultation"),s=document.getElementById("btn-publish"),o=document.getElementById("contacts-form"),n=document.getElementById("contact-form_consultation"),l=document.getElementById("contact-form_send");s?.addEventListener("click",(async e=>{e.preventDefault(),t(r);const c=t(r),o=(()=>{const e=document.querySelectorAll(".publish .service-card"),t=document.querySelectorAll(".publish .service-card.active"),r=!t||0===t.length;if(r){if(e.forEach((e=>e.classList.add("error"))),document.querySelector(".services-publish__error-text"))return;const t=document.querySelector(".publish .services-publish"),r=document.createElement("span");r.classList.add("services-publish__error-text"),r.append("Выберите формат публикации"),t.append(r)}return!r})();if(!c||!o)return;s.classList.remove("success"),s.classList.add("loading");const n=new Promise((e=>{setTimeout((()=>e()),500)}));try{await n}catch(e){console.error(e)}s.classList.remove("loading"),s.classList.add("success")})),[{btn:c,form:r},{btn:n,form:o},{btn:l,form:o,title:"Отправка статьи"}].forEach((({btn:e,form:r,title:c=""})=>{e?.addEventListener("click",(async()=>{e.classList.remove("success"),e.classList.add("loading");try{await(async(e,r)=>{if(!t(e))return;const c=e.querySelectorAll(".text-input__input");return e.querySelector(".text-area__input")?.value,Array.from(c).reduce(((e,t)=>({...e,[t.name]:t.value})),{}),data?.name,data?.phone,data?.email,new Promise((e=>{setTimeout((()=>e()),500)}))})(r)}catch(e){console.error(e)}e.classList.remove("loading"),e.classList.add("success")}))}));const i=document.querySelector(".publish .publish__form-actions .price .price__text"),a=document.querySelectorAll(".service-card"),u=({currentTarget:t})=>{const r=t.closest(".service-card"),c=r.querySelector(".service-card__btn");r.classList.toggle("active"),r.classList.contains("active")?c.innerHTML="Выбрано":c.innerHTML="Выбрать",(()=>{const t=document.getElementById("publish-amount"),r=document.querySelectorAll(".publish .service-card.active .service-card__badge"),c=Array.from(r).reduce(((e,t)=>{const r=t.innerHTML;return e+parseInt(r.replace(/ /g,""))}),0);s.disabled=!c,t.value=c,(t=>{const r=e(t)?`${e(t)} ₽`:"";i.innerHTML=r})(c)})(),(()=>{const e=document.querySelectorAll(".publish .service-card"),t=document.querySelectorAll(".publish .service-card.active");if(t&&0!==t.length){const t=document.querySelector(".publish .services-publish .services-publish__error-text");t?.remove(),e.forEach((e=>e.classList.remove("error")))}})()};a.forEach((e=>e.addEventListener("click",u)));const d=document.querySelector(".header .btn.header__burger"),m=document.querySelector(".header .header__burger-menu");d?.addEventListener("click",(()=>{const e=d.querySelector("use");m.classList.toggle("show"),d.classList.toggle("blue");let t="";m.classList.contains("show")?(document.body.style.overflow="hidden",t="#close"):(document.body.style.overflow="",t="#burger"),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t)}))}))})();